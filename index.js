(()=>{"use strict";class e{constructor({title:e,link:t},s,{handleCardClick:r}){this._templateSelector=s,this._title=e,this._link=t,this._handleCardClick=r}_getTemplate(){return document.querySelector(this._templateSelector).content.querySelector(".element").cloneNode(!0)}_handleLikeClick(){this._likeButton.classList.toggle("element__like_active")}_handleTrashClick(){this._element.remove(),this._element=null}_setEventListeners(){this._likeButton=this._element.querySelector(".element__like"),this._likeButton.addEventListener("click",(()=>this._handleLikeClick())),this._cardImage=this._element.querySelector(".element__image"),this._cardImage.addEventListener("click",(()=>this._handleCardClick(this._title,this._link))),this._trashButton=this._element.querySelector(".element__trash"),this._trashButton.addEventListener("click",(()=>this._handleTrashClick()))}generateCard(){return this._element=this._getTemplate(),this._setEventListeners(),this._cardImage.src=this._link,this._cardImage.alt=this._title,this._cardTitle=this._element.querySelector(".element__title"),this._cardTitle.textContent=this._title,this._element}}Array.from(document.querySelectorAll(".popup")),Array.from(document.querySelectorAll(".popup__button-close"));const t={inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_inactive",inputErrorClass:"popup__input_type_error",errorClass:"popup__input-error_active"},s=document.querySelector(".profile__edit-button"),r=document.querySelector(".popup__input_value_name"),i=document.querySelector(".popup__input_value_description"),n=document.querySelector(".profile__add-button"),o=document.querySelector(".popup__form_block_elements"),l=document.querySelector(".popup__form_block_profile");class p{constructor(e,{inputSelector:t,submitButtonSelector:s,inactiveButtonClass:r,inputErrorClass:i,errorClass:n}){this._form=e,this._inputSelector=t,this._submitButtonSelector=s,this._inactiveButtonClass=r,this._inputErrorClass=i,this._errorClass=n}_setEventListeners(){this._inputList=Array.from(this._form.querySelectorAll(this._inputSelector)),this._buttonElement=this._form.querySelector(this._submitButtonSelector),this._toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))})),this._form.addEventListener("submit",(()=>{this._disableSubmitButton()}))}_toggleButtonState(){this._hasInvalidInput()?this._disableSubmitButton():this._enableSubmitButton()}_enableSubmitButton(){this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.removeAttribute("disabled")}_disableSubmitButton(){this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.setAttribute("disabled",!0)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_showInputError(e){this._errorElement=this._form.querySelector(`.${e.id}-error`),e.classList.add(this._inputErrorClass),this._errorElement.textContent=e.validationMessage,this._errorElement.classList.add(this._errorClass)}_hideInputError(e){this._errorElement=this._form.querySelector(`.${e.id}-error`),e.classList.remove(this._inputErrorClass),this._errorElement.classList.remove(this._errorClass),this._errorElement.textContent=""}hideErrorOpened(){Array.from(this._form.querySelectorAll(this._inputSelector)).forEach((e=>{this._hideInputError(e)}))}enableValidation(){this._setEventListeners()}}class c{constructor(e){this._popup=document.querySelector(e)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};open(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}setEventListeners(){this._popup.querySelector(".popup__overlay").addEventListener("click",(()=>{this.close()})),this._popup.querySelector(".popup__button-close").addEventListener("click",(()=>{this.close()}))}}class _ extends c{constructor(e,t){super(e),this._submiter=t,this._form=this._popup.querySelector(".popup__form"),this._inputList=Array.from(this._form.querySelectorAll(".popup__input"))}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._submiter(this._getInputValues()),this.close()}))}close(){super.close(),this._form.reset()}}const a=new p(o,t),u=new p(l,t),d=t=>new e({title:t.title,link:t.link},".element-template",{handleCardClick:(e,t)=>{k.open(e,t)}}).generateCard();a.enableValidation(),u.enableValidation();const h=new class{constructor({renderer:e},t){this._renderer=e,this._container=document.querySelector(t)}addItem(e,t){!0===t?this._container.prepend(e):this._container.append(e)}renderItems(e){e.forEach((e=>{this._renderer(e)}))}}({renderer:e=>{const t=d(e);h.addItem(t,!1)}},".elements");h.renderItems([{title:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{title:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{title:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{title:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{title:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{title:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}]);const m=new class{constructor({profileNameSelector:e,profileDescriptionSelector:t}){this._profileName=document.querySelector(e),this._profileDescription=document.querySelector(t)}getUserInfo(){return{name:this._profileName.textContent,description:this._profileDescription.textContent}}setUserInfo({name:e,description:t}){this._profileName.textContent=e,this._profileDescription.textContent=t}}({profileNameSelector:".profile__name",profileDescriptionSelector:".profile__description"}),v=new _(".popup_block_elements",(({title:e,link:t})=>{const s=d({title:e,link:t});h.addItem(s,!0)}));v.setEventListeners(),n.addEventListener("click",(()=>{a.hideErrorOpened(),v.open()}));const E=new _(".popup_block_profile",(({name:e,description:t})=>{m.setUserInfo({name:e,description:t})}));E.setEventListeners(),s.addEventListener("click",(()=>{const{name:e,description:t}=m.getUserInfo();r.value=e,i.value=t,u.hideErrorOpened(),E.open()}));const k=new class extends c{constructor(e){super(e),this._image=this._popup.querySelector(".popup__image"),this._description=this._popup.querySelector(".popup__image-description")}open(e,t){super.open(),this._image.src=t,this._image.alt=e,this._description.textContent=e}}(".popup_block_image");k.setEventListeners()})();